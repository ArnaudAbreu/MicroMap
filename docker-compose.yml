version: '3.8'

services:
  server:
    build: server
    command: "flask run --host 0.0.0.0 --port 5000"
    volumes:
      - ./server:/server
      - /data/DeepLearning/SCHWOB_Robin/PACS_slides/1:/data/slides
      - /data/DeepLearning/SCHWOB_Robin/PACS_slides_annots/1:/data/annots
    environment:
      - FLASK_ENV=development
      - FLASK_APP=server.py
      - LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
    ports:
      - "3001:5000"

  app:
    build: app
    command: ["npm", "start"]
    volumes:
      - ./app:/app
      - node-modules:/app/node_modules
    ports:
      - '3000:3000'
    depends_on:
      - server
    links:
      - server

volumes:
  node-modules: